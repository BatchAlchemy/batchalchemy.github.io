[{"id":0,"href":"/posts/batch-syntax-research-summary/","title":"Batch Syntax Research Summary","section":"Posts","content":" Introduction # all experimentation was done from within batch files (=batch mode?) motivated because there is no documentation we aim to help to strengthen the understanding behind it we definitely have not found out every nitty syntax detail of Batch, just some interesting things to know about / consider disclaimer: batch syntax is weird, so keep everything with a grain of salt note: everything we talk about is considered to be done in the context of batch mode (there is a difference between batch mode and dos mode, look it up here) Findings on the Batch Syntax # CALL \u0026amp; valid local filenames # This experiment was motivated by the idea that parenthesis characters may appear in Windows filenames. At the same time they get used in syntactical ways in Batch scripts, such as statements concerning the if and else keywords.\nWe decided to use the call key keyword to test what filenames are to be considered valid command names by the Windows Command Prompt (cmd.exe).\nFor that, we created eleven Batch files, namely x), ).bat, )x.bat, x(.bat, x.bat(, (x.bat, (), ().bat, (x).bat, x.bat) and (.bat, all of which contain the following Batch code:\n@echo inside %0 :: prints the filename of the called file on screen @exit /b :: exits called batch and return to callee This code is meant to display which called file the callee calls.\nSpeaking of the callee, we use the Batch code below for the execution of the experiment. This Batch gets evoked from the Windows Command Prompt to display the results. The comments next to the lines of code represent the result of the corresponding line of code.\ncall x).bat\t:: works; prints `inside x).bat` call ).bat\t:: works; prints `inside ).bat` call )x.bat\t:: works; prints `inside )x.bat` call x(.bat\t:: failure; only `x` gets interpreted as a command_name call x.bat(\t:: failure; only `x.bat` gets interpreted as a command_name call (x.bat\t:: failure; does nothing call (.bat\t:: failure; does nothing call x.bat)\t:: failure; instead tries to open file in another way cuz file ending call ()\t:: syntax error; `)` cannot be used here call ().bat\t:: syntax error; `)` cannot be used here call (x).bat :: syntax error; `.bat` cannot be used here :: note that everything in quotes should work :: note that I shuffled the lines multiple times so parenthesis positions should be tested by that -\u0026gt; it seems to be irrelevant since the results are all the same. As one can see, the first three cases (ll. 1-3) get correctly executed. The corresponding files exist and the closing parentheses to the left of the file extension seem to work without issue.\nA little bit more interesting are the next two cases (ll. 5-6): Here, the opening parenthesis seems to delimit the called filename to the right. Because these files do not exist (yet), we get the following two errors from the Windows Command Prompt:\nC:\\Users\\defaultuser\u0026gt;call x(.bat The command \u0026#34;x\u0026#34; is either misspelled or could not be found. C:\\Users\\defaultuser\u0026gt;call x.bat( The command \u0026#34;x.bat\u0026#34; is either misspelled or could not be found. To check if they map as one might think, we create two more files, namely x and x.bat.\nFirst, the code of the extensionless file x will be:\n@echo inside %0 @echo Actual filename: x @exit /b And the content of x.bat will be mostly the same; it just differs in the hard-coded actual filename, which is to be printed:\n@echo inside %0 @echo Actual filename: x.bat @exit /b Now executing our caller Batch file again, we get the following output from the original ll. 5-6:\nC:\\Users\\defaultuser\u0026gt;call x(.bat inside x Actual filename: x.bat C:\\Users\\defaultuser\u0026gt;call x.bat( inside x.bat Actual filename: x.bat The result shows that the closing parenthesis delimits the filename to be called to the right and that the x.bat has priority when either filename is being interpreted by the Windows Command Prompt.\nThis is backed by the fact that upon removing x.bat from the working directory, the extensionless x will still not be called by the calling lines of code in either case:\nC:\\Users\\defaultuser\u0026gt;call x(.bat The command \u0026#34;x\u0026#34; is either misspelled or could not be found. C:\\Users\\defaultuser\u0026gt;call x.bat( The command \u0026#34;x.bat\u0026#34; is either misspelled or could not be found. The next three cases (ll. 8-10) fail to call the files as well. As seen before, the closing parenthesis in lines 8 and 9 delimit the filenames to the right, now yielding empty filenames (because the files\u0026rsquo; names on disk start with the closing parenthesis). Hence, the Windows Command Prompt interprets these two lines of code simply as a call command with empty arguments, yielding in an empty output with no file being called:\nC:\\Users\\defaultuser\u0026gt;call (x.bat C:\\Users\\defaultuser\u0026gt;call (.bat Line 10 also yields an empty output, but because of the placement of the opening parenthesis (which seemingly does not work as a delimiter as seen before), it is considered part of the file extension. As a result, for us, the Windows OS prompted us with a popup window asking what application we\u0026rsquo;d like to open .bat) files with.\nConsidering the last three lines of code (ll. 12-14), syntax errors get reported by the Windows Command Prompt. In the first two cases, it seems as if the call command gets interpreted again as if it had no arguments. After that interpretation, now having nothing within the pair of parenthesis yields a syntactic error, claiming that ) cannot be used in that place. Note that the Batch does not abort, but instead just skips the syntactically erroneous line of code. Speaking of the very last case, now having a non-empty parentheses, the output claims that .bat suddenly became the syntax problem. Again call is probably being interpreted without having any arguments, the parentheses get interpreted as a code block and thus the file extension is out of place.\nConclusion: Filenames containing opening parenthesis can lead to unintentional interpretation by the Windows Command Prompt, although their existence is inherently permitted within the Windows OS. Also, there can be a difference between how a Batch thinks it got evoked and how it is actually being evoked.\nFuture research Future research of interpretation of Windows filenames in connexion with Batch code blocks like the ones within if-else statements\nIF Keyword WIP # "}]